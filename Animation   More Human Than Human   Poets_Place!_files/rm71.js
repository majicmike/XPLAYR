var Spotify=function(d){d.Config={_configuration:{debug:!1,tracking:!0,server:"//embed.spotify.com/","yahoo-target-origin":"https://embed.spotify.com","open-url":"//open.spotify.com/","mediabar-url":"https://embed.spotify.com/mediabar/","link-url":"https://play.spotify.com/","play-now-url":"https://embed.spotify.com/registration/play-now.php","logging-prefix":"[SPB]","entity-renderer-url":"//embed.spotify.com/mediabar/entity/","fb-app-id":"174829003346","registration-module-browser-versions":{firefox:14,
chrome:21,safari:5,explorer:8},"link-enabled":!0,"link-browser-versions":{chrome:21,firefox:14,safari:5,explorer:9},"mediabar-browser-versions":{chrome:21,firefox:14,safari:5},"play-now-markets":["uk"],"download-links":{windows:{"default":"https://d1clcicqv97n4s.cloudfront.net/SpotifySetup.exe"},mac:{"default":"https://d1clcicqv97n4s.cloudfront.net/Spotify.dmg",app:"https://d1clcicqv97n4s.cloudfront.net/SpotifyInstaller.zip"}},"spotify-target-origin":"https://embed.spotify.com","allowed-origins":["https://embed.spotify.com",
"http://music.yahoo.com","https://d1tgm0mcw6tx0m.cloudfront.net","https://d34f388hvlfgq4.cloudfront.net","https://d20nan3osubr3.cloudfront.net"]},set:function(a,b){this._configuration[a]=b},get:function(a){var b=null;"undefined"!==typeof this._configuration[a]&&this._configuration.hasOwnProperty(a)&&(b=this._configuration[a]);return b}};return d}(Spotify||{});Spotify=function(d){d.Logger={log:function(a,b,c){Spotify.Config.get("debug")&&this.isConsoleAvailable()&&("undefined"===typeof c&&(c=!1),a=Spotify.Config.get("logging-prefix")+a,d.BrowserDetect.init(),"chrome"==d.BrowserDetect.browser.toLowerCase()&&c&&(c=Error().stack.split("\n")[2],a+="\n"+c,"undefined"!==typeof b&&(a+="\n")),"undefined"!==typeof b?console.log(a,b):console.log(a))},isConsoleAvailable:function(){return window.console?!0:!1}};return d}(Spotify||{});Array.prototype.indexOf||(Array.prototype.indexOf=function(d,a){var b=this.length,c=Number(a)||0,c=0>c?Math.ceil(c):Math.floor(c);for(0>c&&(c+=b);c<b;c++)if(c in this&&this[c]===d)return c;return-1});Spotify=function(d){var a=null;d.Util={_isYUILoaded:function(){return"undefined"!==typeof YAHOO&&YAHOO.util},_isJQueryLoaded:function(){return"undefined"!==typeof jQuery},byClassName:function(b,a){"undefined"===typeof a&&(a=document);var e=[];try{a.querySelectorAll?e=a.querySelectorAll("."+b):this._isYUILoaded()&&(e=YAHOO.util.Dom.getElementsByClassName(b,void 0,a))}catch(d){var g=document.getElementsByTagName("*");for(i=0;i<g.length;i++)if(g[i].getAttribute("class")){ecl=g[i].getAttribute("class").split(" ");
for(j=0;j<ecl.length;j++)ecl[j].toLowerCase()==b.toLowerCase()&&e.push(g[i])}else if(g[i].className){ecl=g[i].className.split(" ");for(j=0;j<ecl.length;j++)ecl[j].toLowerCase()==b.toLowerCase()&&e.push(g[i])}}return e},randomId:function(){return"spotify-"+Math.floor(1E5*Math.random())},position:function(b){var a={x:0,y:0};this._isYUILoaded()?(a=YAHOO.util.Dom.getXY(b),a={x:a[0],y:a[1]}):b.getBoundingClientRect&&(b=b.getBoundingClientRect(),a={x:parseInt(b.left,10),y:parseInt(b.top,10)});return a},
setPosition:function(b,a){this._isYUILoaded()?YAHOO.util.Dom.setXY(b,[a.x,a.y]):(b.style.left=a.x+"px",b.style.top=a.y+"px")},size:function(b){var a=null;return a=this._isYUILoaded()?[parseInt(YAHOO.util.Dom.getStyle(b,"width"),10),parseInt(YAHOO.util.Dom.getStyle(b,"height"),10)]:this._isJQueryLoaded()?[parseInt(jQuery(b).width(),10),parseInt(jQuery(b).height(),10)]:[b.offsetWidth,b.offsetHeight]},domReady:function(b){if(this._isYUILoaded()&&"function"===typeof b)Y.on("domready",function(){b()})},
isBrowserCompatible:function(b,a){var e=!1;"undefined"===typeof a&&(a=!1);Spotify.BrowserDetect.initialized||Spotify.BrowserDetect.init();var d=Spotify.BrowserDetect.browser.toLowerCase(),g=Spotify.BrowserDetect.version,h=Spotify.Config.get(b);h&&"undefined"!==typeof h[d]&&(e=g>=h[d]);a||(e=e&&""!==Spotify.Download.getInstallerLink());return e},isPostMessageCompatible:function(){return window.postMessage?!0:!1},attachEvent:function(b,a,e){"undefined"===typeof e&&(e=window);e.addEventListener?e.addEventListener(b,
a,!1):e.attachEvent&&e.attachEvent("on"+b,a)},removeEvent:function(b,a,e){"undefined"===typeof e&&(e=window);e.removeEventListener&&e.removeEventListener(b,a)},getWindowSize:function(){var b=[0,0];return b=window.innerWidth?[window.innerWidth,window.innerHeight]:[Math.max(document.documentElement.clientWidth,document.body.clientWidth),Math.max(document.documentElement.clientHeight,document.body.clientHeight)]},removeNode:function(b){b.parentNode.removeChild(b)},isAttributeSupported:function(b,a){return"undefined"!==
typeof document.createElement(b)[a]},openWindow:function(b,a,e,d){a=a.replace("-","");(b=window.open(b,a,"height="+d+",width="+e+",resizable=yes,scrollbars=no,status=no,toolbar=no,menubar=no"))&&b.focus();return b},ajax:function(b,a,e,d,g){this._isJQueryLoaded()&&(b={url:b,data:a,success:e,error:e,type:"undefined"===typeof g?"GET":"POST"},"undefined"!==typeof d&&(b.timeout=d),$.ajax(b))},eventTarget:function(b){return b.target?b.target:b.srcElement},onUnload:function(b){window.onbeforeunload=function(){if("function"===
typeof b)return b()}},computeExtraOffset:function(){var b=0,a=0,e=a=b=0,d=0;if(window.innerWidth&&window.outerHeight)b=window.innerWidth,a=window.innerHeight,e=window.outerWidth,d=window.outerHeight;else if(document.documentElement.clientWidth)try{var g=document.documentElement.clientWidth,h=document.documentElement.clientHeight;window.resizeTo(g,h);var e=g-document.documentElement.clientWidth,d=h-document.documentElement.clientHeight,l=g+e,k=h+d;window.resizeTo(l,k);if(g!=document.documentElement.clientWidth||
h!=document.documentElement.clientHeight)e=l-document.documentElement.clientWidth,d=k-document.documentElement.clientHeight}catch(m){}b=Math.abs(b-e);a=Math.abs(a-d);return[b,a]},resizeWindow:function(b){if(!window.innerHeight){try{window.resizeTo(b[0]+20,b[1]+100)}catch(a){}return!0}b=b.slice(0);"undefined"===typeof b[0]?b=[0,0]:"undefined"===typeof b[1]&&(b[1]=0);var d=this.computeExtraOffset(b);b[0]+=d[0];b[1]+=d[1];d=b[0];b=b[1];try{window.resizeTo(d,b)}catch(f){}},setLocationWithIframe:function(b){b=
Spotify.View.render("iframe",{src:b,style:"display:none"});document.getElementsByTagName("body")[0].appendChild(b)},stopPropagation:function(b){b.stopPropagation?b.stopPropagation():"undefined"!==typeof b.cancelBubble&&(b.cancelBubble=!0)},isIE8:function(){return"explorer"===Spotify.BrowserDetect.browser.toLowerCase()&&8===Spotify.BrowserDetect.version},iframeReady:function(b,a){b.attachEvent?b.attachEvent("onload",a):b.onload=a},readableTime:function(b){var a=b/1E3/60,b=Math.floor(a),a=Math.round(60*
(a-b));60==a&&(b++,a=0);return 10>a?b+":0"+a:b+":"+a},pageTitle:function(){var a="",c=document.getElementsByTagName("title");0<c.length&&(a=c[0].innerHTML);return a},addClass:function(a,c){-1===a.className.indexOf(c)&&(a.className+=" "+c)},removeClass:function(a,c){a.className=a.className.replace(" "+c,"")},isLocalStorageSupported:function(){if(null===a){var b=new Date,c,d;try{(c=window.localStorage).setItem(b,b),d=c.getItem(b)==b,c.removeItem(b),a=!(!d||!c)}catch(f){a=!1}}return a},parseJSON:function(a){var c=
null;try{c=JSON.parse(a)}catch(d){}return c},getChallengeToken:function(){return"undefined"!==typeof Spotify.challengeToken?Spotify.challengeToken:""},setInterval:function(a,c){var d=new Date,f=0;return setInterval(function(){var g=(new Date).getTime()-d.getTime()+f,h=parseInt(g/c)*c;f=g%c;a(h);d=new Date},c)}};return d}(Spotify||{});Spotify=function(d){d.View={render:function(a,b){"string"===typeof a&&(a=this.views[a]);var c=document.createElement(a.type),c=this.includeAttributes(c,a,b);"undefined"!==typeof a.children?c=this.addChildren(c,a.children):"undefined"!==typeof a.content&&(c.innerHTML=a.content);return c},renderResource:function(a){var b=null;switch(a.split(".").pop().toLowerCase()){case "css":b=this.render("css-node",{href:a});break;case "js":b=this.render("js-node",{src:a})}return b},includeAttributes:function(a,
b,c){"undefined"!==typeof b.randomId&&b.randomId&&(a.id=Spotify.Util.randomId());a=this.applyAttributes(b.attributes,a);return a=this.applyAttributes(c,a)},applyAttributes:function(a,b){if("undefined"!==typeof a)for(var c in a)a.hasOwnProperty(c)&&b.setAttribute(c,a[c]);return b},addChildren:function(a,b){for(var c=b.length,d=0;d<c;d++){var f=this.render(b[d]);a.appendChild(f)}return a},views:{"base-popup":{type:"div",attributes:{"class":"spotify-popup"},randomId:!0,children:[{attributes:{"class":"spotify-dialog"},
type:"div"}]},"js-node":{type:"script",attributes:{type:"text/javascript"}},iframe:{type:"iframe"},"css-node":{type:"link",attributes:{rel:"stylesheet",type:"text/css"}},loader:{type:"div",attributes:{"class":"spotify-throbber-small"}},"loader-big":{type:"div",attributes:{"class":"spotify-throbber-big"}}}};return d}(Spotify||{});Spotify=function(d){d.FbStatus={DISCONNECTED:"disconnected",CONNECTED:"connected",NOT_AUTHORIZED:"not-authorized",ERROR:"error"};d.Fb=function(){var a=null,b=Spotify.FbStatus.DISCONNECTED,c=null,d=Spotify.Logger,f=function(b,c,d){a=a||window.FB;a.init({appId:b.appId,music:"music"in b?b.music:!1,cookie:"cookie"in b?b.cookie:!0,status:"status"in b?b.status:!1,xfbml:"xfbml"in b?b.xfbml:!1,oauth:"oauth"in b?b.oauth:!1});g(c,d)},g=function(b,c){a.getLoginStatus(function(a){h(a,b,c)},!0)},h=function(a,
g,f){d.log("[FB] checking response",a);switch(a.status){case "connected":b=Spotify.FbStatus.CONNECTED;"undefined"!==typeof a.authResponse&&(c=a.authResponse);g(a);break;case "not_authorized":b=Spotify.FbStatus.NOT_AUTHORIZED;f(a);break;default:b=Spotify.FbStatus.DISCONNECTED,f(a)}};this.getAuthResponse=function(){return c};this.connect=function(b,c){if(!b||"string"!==typeof b.appId)throw Error("AppId required");if(a)g(c,c);else{var d=Spotify.View.renderResource("https://connect.facebook.net/en_US/all/vb.js");
0<document.getElementsByTagName("head").length&&document.getElementsByTagName("head")[0].appendChild(d);window.FB?f(b,c,c):window.fbAsyncInit=function(){f(b,c,c)}}};this.getApi=function(){if(a)return a;throw Error("FB API not initialized");};this.login=function(a,b){this.getApi().login(function(c){h(c,a,b)})};this.getStatus=function(){return b};this.getGDPURL=function(a,b){var c;c="https://www.facebook.com/connect/uiserver.php?method=permissions.request&app_id="+Spotify.Config.get("fb-app-id");c=
c+"&perms=publish_actions,email,user_birthday&display=popup&locale=en_US&redirect_uri="+(encodeURIComponent(a)+"&cancel_url=");c+=encodeURIComponent(b);return c+"&height=365&width=612&fbconnect=1&TB_iframe=true&modal=true"};this.getConnectURL=function(a,b){var c=Spotify.Config.get("fb-app-id");nextUrl=encodeURIComponent(this.getGDPURL(a,b));encodeURIComponent(a);b=encodeURIComponent(b);return"https://www.facebook.com/login.php?api_key="+c+"&skip_api_login=1&display=dialog&cancel_url="+b+"&fbconnect=1&next="+
nextUrl+"&rcount=1"}};return d}(Spotify||{});Spotify=function(d){d.BrowserDetect={initialized:!1,init:function(){this.initialized||(this.browser=this._searchString(this.dataBrowser)||"An unknown browser",this.version=this._searchVersion(navigator.userAgent)||this._searchVersion(navigator.appVersion)||"an unknown version",this.OS=this._searchString(this.dataOS)||"an unknown OS",this.initialized=!0)},_searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(-1!=
c.indexOf(a[b].subString))return a[b].identity}else if(d)return a[b].identity}},_searchVersion:function(a){var b=a.indexOf(this.versionSearchString);return-1==b?void 0:parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,
identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",
versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],getUserAgent:function(){return window.navigator.userAgent}};return d}(Spotify||{});Spotify=function(d){d.Popup=function(a){var b=this;"undefined"===typeof a.autoClose&&(a.autoClose=!1);"undefined"===typeof a.absolute&&(a.absolute=!0);var c={iframeSrc:a.iframeSrc||null,parentElement:a.parentElement||document.body,sourceElement:a.sourceElement||null,view:a.view||null,onAfterRender:a.onAfterRender||null,onBeforeShow:a.onBeforeShow||null,size:a.size||null,absolute:a.absolute,offset:a.offset||null,id:a.id||null,autoClose:a.autoClose,template:a.template||null,actions:a.actions||null,
popupWindow:a.popupWindow?a.popupWindow:!1,onHideCallback:a.onHideCallback?a.onHideCallback:null},d=!1,f=null,g=null;this.show=function(){if(!d){f.children[0].style.display="block";if(c.iframeSrc===null)f.className=f.className+" spotify-show";g||(g=Spotify.Util.byClassName("spotify-dialog",f)[0]);if(c.size&&c.size.length>0)g.style.width=c.size[0]+"px";if(c.size&&c.size.length>1)g.style.height=c.size[1]+"px";c.popupWindow||l();Spotify.Util.attachEvent("resize",k);if(c.autoClose){Spotify.Util.attachEvent("keydown",
m);Spotify.Util.attachEvent("click",m)}d=true;if(typeof c.onBeforeShow==="function")c.onBeforeShow()}};this.hide=function(){if(d){f.className=f.className.replace(" spotify-show","");d=false;if(window.removeEventListener){Spotify.Util.removeEvent("resize",k);if(c.autoClose){Spotify.Util.removeEvent("keydown",m);Spotify.Util.removeEvent("click",m)}}if(typeof c.onHideCallback==="function")c.onHideCallback()}};this.size=function(){return Spotify.Util.size(g)};this.destroyElement=function(){f&&Spotify.Util.removeNode(f)};
this.overrideOptions=function(a,b){c[a]=b};this.getOptions=function(){return c};this.getContainer=function(){return g};this.setPosition=function(){l()};this.isVisible=function(){return d};var h=function(){var a=Spotify.View.render("iframe",{src:c.iframeSrc});Spotify.Util.iframeReady(a,function(){f.className=f.className+" spotify-show"});return a},l=function(){var a=Spotify.Util.size(g);if(typeof c.absolute!=="undefined"&&c.absolute){g.style.position="absolute";f.style.position="absolute"}if(c.sourceElement){var b=
Spotify.Util.size(c.sourceElement),d=Spotify.Util.position(c.sourceElement),a=-1*(a[0]/2-b[0]/2),b=c.sourceElement.offsetHeight;if(c.offset){a=a+c.offset[0];b=b+c.offset[1]}Spotify.Util.setPosition(g,{x:d.x+a,y:d.y+b})}else if(a){d=Spotify.Util.getWindowSize();g.style.top=parseInt(d[1],10)/2-a[1]/2+"px";g.style.marginLeft="-"+a[0]/2+"px"}},k=function(){c.popupWindow||l()},m=function(a){d&&(a.type==="click"||a.keyCode==27)&&b.hide()};(function(){if(f=Spotify.View.render("base-popup")){var a=null;if(c.iframeSrc)a=
h();else if(c.view)a=Spotify.View.render(c.view);else if(c.template){a=c.template;Spotify.Util.removeNode(c.template)}f.children[0].style.display="none";f.children[0].appendChild(a);if(c.id)f.className=f.className+(" "+c.id);c.parentElement.appendChild(f);if(typeof c.onAfterRender==="function")c.onAfterRender(f);if(typeof c.actions==="object"&&c.actions!==null){for(var b in c.actions)c.actions.hasOwnProperty(b)&&typeof c.actions[b]==="function"&&b!=="onRender"&&Spotify.Util.attachEvent("click",c.actions[b],
document.getElementById(b));if(typeof c.actions.onRender==="function")c.actions.onRender()}}})()};return d}(Spotify||{});Spotify=function(d){d.Cookie={get:function(a){for(var b=document.cookie.split(";"),c="",d="",f="",g=0;g<b.length;g++)if(c=b[g].split("="),d=c[0].replace(/^\s+|\s+$/g,""),d==a)return 1<c.length&&(f=unescape(c[1].replace(/^\s+|\s+$/g,""))),f;return null},set:function(a,b,c,d,f,g){var h=new Date;h.setTime(h.getTime());c&&(c*=864E5);h=new Date(h.getTime()+c);document.cookie=a+"="+escape(b)+(c?";expires="+h.toGMTString():"")+(d?";path="+d:"")+(f?";domain="+f:"")+(g?";secure":"")},unset:function(a){var b=
new Date;b.setFullYear(b.getFullYear()-1);document.cookie=a+"=null; expires="+b}};return d}(Spotify||{});Spotify=function(d){d.isSpotified=function(){return"1"==Spotify.Cookie.get("spotified")};d.isLinkSpotified=function(){return Spotify.Config.get("link-enabled")&&(null!==Spotify.Cookie.get("link_spb")||null!==Spotify.Cookie.get("from_wp"))};d.setSpotified=function(a){Spotify.Cookie.set("spotified",a?"1":"0",365)};return d}(Spotify||{});Spotify=function(d){d.Url={_filterUrl:function(a){"undefined"===typeof a?(a=window.location.search,""!==a&&(a=a.replace("?",""))):(a=a.split("?"),a=1<a.length?a[1]:"");""!==a&&(a=a.split("#"),a=a[0]);return a},read:function(a){var b={},a=this._filterUrl(a);if(""!==a)for(var a=a.split("&"),c=a.length,d=0;d<c;d++){var f=a[d],f=f.split("=");1<f.length&&(b[f[0]]=decodeURIComponent(f[1]))}return b},generate:function(a,b,c){var d="";"undefined"===typeof c&&(c=location.protocol);var d=c+a,a=!0,f;for(f in b)b.hasOwnProperty(f)&&
(a?(d+="?",a=!1):d+="&",d+=f+"="+encodeURIComponent(b[f]));return d},addParameters:function(a,b){a=-1===a.indexOf("?")?a+"?":a+"&";return a+b}};return d}(Spotify||{});Spotify=function(d){d.Message={PLAYER_STATUS:"player-status",CONTROL_POPUP:"control-popup",CLIENT_CONNECTED:"client-connected",CLIENT_CONNECTION_FAILED:"client-connection-failed",CLIENT_DISCONNECTED:"client-disconnected",CLIENT_ERROR:"client-error",MINI_BUTTON_PLAY_PAUSE:"mini-button-play-pause",MINI_BUTTON_REPORT:"mini-button-report",MINI_BUTTON_VIEW_MORE:"mini-button-view-more",MEDIABAR_PLAY_PAUSE:"mediabar-play-pause",MEDIABAR_SHOW:"mediabar-show",ENTITIES_LIST:"entities-list",REGISTRATION_MODULE:"registration-module",
TOGGLE_MENU:"toggle-menu",TOGGLE_PLAY_PAUSE:"toggle-play-pause",FEATURED_ENTITIES:"featured-entities",CHECK_CLIENT:"check-client",PLAY_PAUSE_CURRENT:"play-pause-current",PAUSE:"pause",PLAY_SPOTIFY_URI:"play-spotify-uri",PLAY_PAUSE_TRACK:"play-pause-track"};var a=function(a){"undefined"===typeof a&&(a={});var c=a.target||window.parent,e=a.targetOrigin||"*";this.attachSendToChildren=function(a){var b=this,c=function(c){c.propagate&&b.send(c.key,c,a.contentWindow)},e;for(e in d.Message)if(d.Message.hasOwnProperty(e)){var k=
this.getCallbackName(d.Message[e]);a[k]=c}};this.send=function(a,b,d,l,k){if(Spotify.Util.isPostMessageCompatible())if("undefined"===typeof b&&(b={}),"undefined"===typeof k&&(k=!0),"undefined"===typeof b.unique&&(b.unique=Spotify.Util.randomId()),"undefined"===typeof b.propagate&&(b.propagate=k),"undefined"===typeof d&&(d=c),a={key:a,data:b},l)for(l=0;l<d.length;l++)b=e,d[l].postMessage(JSON.stringify(a),b);else d.postMessage(JSON.stringify(a),e)};this.getCallbackName=function(a){for(var b="",a=a.split("-"),
b=a.length,c=0;c<b;c++)a[c]=a[c].charAt(0).toUpperCase()+a[c].slice(1);b=a.join("");return"on"+b}};d.Publisher={instance:null,getInstance:function(b){this.instance||(this.instance=new a(b));return this.instance}};return d}(Spotify||{});Spotify=function(d){d.Tracking={TIMEOUT:2E3,send:function(a,b){b="undefined"===typeof b?!1:b&&_gaq;this.isEnabled()&&(b?_gaq.push(["_trackEvent",a.category,a.action,a.value,0,!0]):Spotify.Util.ajax("../l/",a,void 0,this.TIMEOUT),Spotify.Logger.log("Tracking step ",a))},isEnabled:function(){return Spotify.Config.get("tracking")}};return d}(Spotify||{});Spotify=function(d){var a={spb:{source:"embed.spotify.com",campaign:"spb"},yahoo:{source:"music.yahoo.com",campaign:"yahoo"}};d.Webplayer={getValidUrl:function(a){"spotify:"===a&&(a="");if(""!==a)if(a=a.split(":"),"trackset"===a[1])var c=""!==a[2]?a[2]:"default",d=a[3].replace("#","/%23/"),a=a[1]+"/"+c+"/"+d;else a=a.splice(1).join("/");return Spotify.Config.get("link-url")+a},open:function(a){"undefined"===typeof a&&(a={});var a={uri:a.uri||"",token:a.token||null,checkIsLinkSpotified:a.checkIsLinkSpotified||
!1,fbBridge:a.fbBridge||null,source:a.source||"spb"},c=this.getValidUrl(a.uri),c=this.addParameters(c,a);Spotify.isLinkSpotified()||!a.checkIsLinkSpotified?window.open(c):$.ajax({async:!1,url:"./xhr/auth-link.php",data:{token:Spotify.Util.getChallengeToken()},success:function(a){"true"===a.status&&window.open(c)},type:"POST"})},addParameters:function(a,c){null!==c.token&&(a=Spotify.Url.addParameters(a,"oauth_token="+c.token));null!==c.fbBridge&&c.fbBridge.getStatus()===Spotify.FbStatus.CONNECTED&&
(a=Spotify.Url.addParameters(a,"flow=fb"));"yahoo"==c.source&&(a=Spotify.Url.addParameters(a,"spb_referrer=yahoo"));var d=this.getTrackingParameters(c.source),a=Spotify.Url.addParameters(a,"utm_source="+encodeURIComponent(d.source)+"&utm_medium="+encodeURIComponent(d.campaign)+"&utm_campaign="+encodeURIComponent(d.campaign));return a=Spotify.Url.addParameters(a,"spb_user=true")},getTrackingParameters:function(b){var c={source:"embed.spotify.com",campaign:"spb"};"undefined"!==typeof a[b]&&(c=a[b]);
return c},isCompatible:function(){return Spotify.Util.isBrowserCompatible("link-browser-versions",!0)&&this.isEnabled()&&Spotify.Util.isLocalStorageSupported()},isEnabled:function(){return Spotify.Config.get("link-enabled")}};return d}(Spotify||{});Spotify=function(d){d.PlayNow={Context:{MEDIABAR:"mediabar",SPB:"spb",ENTITY:"entity"},isEnabled:function(a){return-1!==Spotify.Config.get("play-now-markets").indexOf(a)&&Spotify.Webplayer.isCompatible()},getServiceByContext:function(a){var b="";switch(a){default:case this.Context.SPB:b="./registration/xhr/auth-link.php";break;case this.Context.MEDIABAR:b="../registration/xhr/auth-link.php";break;case this.Context.ENTITY:b="../../registration/xhr/auth-link.php"}return b},applyAnalyticsParameters:function(a){var b=
"",c="";switch(a){default:case this.Context.SPB:b="SPB";c=frameReferrer;break;case this.Context.MEDIABAR:case this.Context.ENTITY:b="music.yahoo.com",c=document.referrer}return[b,c]},activate:function(a,b){"undefined"===typeof a&&(a=this.Context.SPB);var c;c=Spotify.Webplayer.addParameters("",{fbBridge:null,token:null,source:a===this.Context.SPB?"spb":"yahoo"});var d=Spotify.Config.get("play-now-url"),d=Spotify.Url.addParameters(d,"p="+encodeURIComponent(c)),d=Spotify.Url.addParameters(d,"token="+
Spotify.Util.getChallengeToken()),d=Spotify.Url.addParameters(d,"uri="+b);c=this.applyAnalyticsParameters(a);d=Spotify.Url.addParameters(d,"cp="+encodeURIComponent(c[0]));d=Spotify.Url.addParameters(d,"cr="+encodeURIComponent(c[1]));Spotify.Logger.log("Opening play now: "+d);window.open(d)}};return d}(Spotify||{});Spotify=function(d){d.RegistrationModule=new function(){this.popupManager=null;var a,b="download",c="REGMODULE_OTHER",e=!1,f=null,g=null,h=null,l=null;this.isFacebookConnected=!1;this.parameters={};var k=["signup-template","already-have-spotify-template","country-template","signup-email-template"];this.isResponse=function(){return"response"===this.parameters.action};this.open=function(a,b,g,h){"undefined"!==typeof a&&(c=a);"undefined"!==typeof a&&"open-pages"==a&&(c=b);"undefined"!==typeof g&&(f=
g);"undefined"!==typeof h&&(e=h);a=this.getUrl("select-login");d.Util.openWindow(a,"select-login",340,476)};this.getUrl=function(a,g){var h={};h.action="undefined"!==typeof a?a:this.parameters.action;h.uri="undefined"!==typeof context?context:this.parameters.uri;h.useWebPlayer="undefined"!==typeof this.parameters.useWebPlayer?this.parameters.useWebPlayer:e;"undefined"!==typeof g&&g&&(h.isRedirect="true");null!==b&&(h.creationFlow=b);null!==c&&(h.creationPoint=c);null!==f&&(h.creationReferral=f);return Spotify.Url.generate(d.Config.get("server")+
"registration/",h)};this.getPopupManager=function(){return this.popupManager};this.onFbConnect=function(){var a=d.RegistrationModule;a.isFacebookConnected=!0;var b=!1;-1<window.location.hash.indexOf("emailAuth")&&(b=window.location.hash.replace("#emailAuth=",""),a.setSignupByEmailToken(b),b=!0);if(b)this.useWebPlayer()?(Spotify.Actions.WebPlayer.TokenControl.set(this.getSignupByEmailToken()),this.Tracking.send(a.Tracking.OPEN_WEBPLAYER),this.popupManager.show(d.PopupInfo.OPEN_WEBPLAYER.id)):(this.Tracking.send(this.Tracking.DOWNLOAD_SIGNUP_EMAIL_SEC),
this.popupManager.show(d.PopupInfo.DOWNLOAD.id));else switch(l.getStatus()){case d.FbStatus.CONNECTED:this.useWebPlayer()?(this.Tracking.send(a.Tracking.OPEN_WEBPLAYER),this.popupManager.show(d.PopupInfo.OPEN_WEBPLAYER.id)):(this.Tracking.send(n(this)),this.popupManager.show(d.PopupInfo.DOWNLOAD.id));break;case d.FbStatus.DISCONNECTED:case d.FbStatus.NOT_AUTHORIZED:case d.FbStatus.ERROR:this.Tracking.send(this.Tracking.SELECT_LOGIN),this.popupManager.show(d.PopupInfo.SELECT_LOGIN.id)}};this.initializePopups=
function(){this.popupManager=new d.PopupManager;this.popupManager.create(d.PopupInfo.DOWNLOAD.id);this.popupManager.create(d.PopupInfo.OPEN_WEBPLAYER.id);this.popupManager.create(d.PopupInfo.SELECT_LOGIN.id);this.popupManager.create(d.PopupInfo.SIGNUP_EMAIL.id);this.popupManager.create(d.PopupInfo.COUNTRY.id);this.popupManager.create(d.PopupInfo.ALREADY.id)};this.init=function(h){var k=this;Spotify.BrowserDetect.initialized||Spotify.BrowserDetect.init();g=Spotify.RemoteControlInit;a=h;this.parameters=
Spotify.Url.read();b=this.parameters.creationFlow;c=this.parameters.creationPoint;f=this.parameters.creationReferral;p.apply(this)&&this.Tracking.send(this.Tracking.CANCEL_FB);"undefined"===typeof this.parameters.overlayMode&&(this.parameters.overlayMode=!1);"undefined"===typeof this.parameters.notifyBridge?this.parameters.notifyBridge=!1:(Spotify.Publisher.getInstance().send(Spotify.Message.CHECK_CLIENT,{getInfo:!0},window.parent),window.onstorage=function(a){if(a.key==="current-context"){a=Spotify.Util.parseJSON(a.newValue);
k.parameters.uri=a.uri}});this.parameters.useWebPlayer="true"===this.parameters.useWebPlayer?!0:!1;this.parameters.useWebPlayer||(this.parameters.useWebPlayer="music.yahoo.com"===this.parameters.creationPoint?!0:e);this.initializePopups();countryAvailable?(l=new d.Fb,l.connect({appId:d.Config.get("fb-app-id")},function(){k.onFbConnect()})):this.popupManager.show(Spotify.PopupInfo.COUNTRY.id);this.parameters.overlayMode&&(Spotify.Util.attachEvent("click",function(a){a.target.parentElement===null&&
o(k.popupManager)}),Spotify.Util.attachEvent("keydown",function(a){a.keyCode==27&&o(k.popupManager)}),m())};var m=function(){for(var a=function(){Spotify.Publisher.getInstance().send(Spotify.Message.CONTROL_POPUP,{popupId:"registration-module",control:"hide"},window.parent)},b=0;b<k.length;b++){var c=document.querySelector("#"+k[b]+" .close-overlay");c.style.display="block";Spotify.Util.attachEvent("click",a,c)}},o=function(a){a.isVisible(d.PopupInfo.SELECT_LOGIN.id)&&Spotify.Publisher.getInstance().send(Spotify.Message.CONTROL_POPUP,
{popupId:"registration-module",control:"hide"},window.parent)};this.redirectToFacebookCheck=function(){l||(l=new d.Fb);var a=this.getUrl(void 0,!0),b=this.getUrl("cancel",!0),a=l.getConnectURL(a,b);window.location=a};this.setSignupByEmailToken=function(a){h=a};this.getSignupByEmailToken=function(){return h};this.getFBBridge=function(){return l};this.playContext=function(b){"undefined"!==typeof this.parameters.uri&&g.check({token:a,creationFlow:this.parameters.creationFlow,creationPoint:this.parameters.creationPoint,
creationReferral:this.parameters.creationReferral,fbBridge:l,signupByEmailToken:h,notifyBridge:this.parameters.notifyBridge,overlayMode:this.parameters.overlayMode},b)};this.getContextUri=function(){var a="spotify:track:";"undefined"!==typeof this.parameters.uri&&(a=this.parameters.uri);return a};this.getFbStatus=function(){return null!=l?l.getStatus():Spotify.Fb.DISCONNECTED};this.isCompatible=function(){return Spotify.Util.isBrowserCompatible("registration-module-browser-versions")};this.useWebPlayer=
function(){return this.parameters.useWebPlayer&&Spotify.Webplayer.isCompatible()};this.getFBBridge=function(){return l};this.close=function(){var a=this;window.setInterval(function(){a.parameters.notifyBridge?Spotify.Publisher.getInstance().send(Spotify.Message.CONTROL_POPUP,{popupId:"registration-module",control:"hide"},window.parent):window.close()},400)};var n=function(a){var b=a.Tracking.DOWNLOAD_DIRECT;"undefined"!==typeof a.parameters.isRedirect&&"true"===a.parameters.isRedirect&&(b=a.Tracking.DOWNLOAD_SIGNUP_FACEBOOK);
return b},p=function(){return"undefined"!==typeof this.parameters.action&&"cancel"===this.parameters.action}};return d}(Spotify||{});Spotify.RegistrationModule=function(d){d.Tracking={GDP:"facebook_gdp",CANCEL_FB:"cancel_facebook",DOWNLOAD_DIRECT:"download_direct",DOWNLOAD_SIGNUP_FACEBOOK:"download_signup_facebook",DOWNLOAD_SIGNUP_EMAIL:"download_signup_email",SELECT_LOGIN:"select_login",SIGNUP_FACEBOOK:"signup_facebook",SIGNUP_EMAIL:"signup_email",SIGNUP_EMAIL_FAILED:"signup_email_failed",ALREADY_HAVE_SPOTIFY:"already_have_spotify",DOWNLOAD_SIGNUP_EMAIL_SEC:"download_signup_email_sec",OPEN_WEBPLAYER:"open_webplayer",TIMEOUT:1E3,
TRACK_STEP:"30",send:function(a,b){if(this.isEnabled()){var c={t:this.TRACK_STEP,s:a,fb:d.getFbStatus()};"undefined"!==typeof d.parameters.creationReferral&&null!==d.parameters.creationReferral&&(c.ref=d.parameters.creationReferral);Spotify.Logger.log("Tracking step ",c);Spotify.Util.ajax("../l/",c,b,this.TIMEOUT)}else"function"===typeof b&&b()},isEnabled:function(){return Spotify.Config.get("tracking")}};return d}(Spotify.RegistrationModule||{});Spotify=function(d){d.RemoteControlInit={listeners:{onConnected:[],onFailed:[]},lastTimeFailed:!1,SPR:null,attach:function(a,b){"undefined"!==typeof this.listeners[a]&&this.listeners[a].push(b)},trigger:function(a){if("undefined"!==typeof this.listeners[a])for(var b=this.listeners[a].length,c=0;c<b;c++){var d=this.listeners[a][c];"function"===typeof d&&d()}},_initWithFacebook:function(a){var b=a.fbBridge.getAuthResponse();if(null!==b){var c=this;Spotify.Util.ajax("xhr/auth.php",{fbuid:b.userID,accessToken:b.accessToken,
creationFlow:a.creationFlow,creationPoint:a.creationPoint,creationReferral:a.creationReferral},function(b){c.initializeRemoteControl(a,b.oauth)},1E4,!0)}else this.initializeRemoteControl(a)},_initWithEmailSignup:function(a){this.initializeRemoteControl(a)},check:function(a,b){b?(this.playUri(),this.initializeRemoteControl(a)):null===a.signupByEmailToken?this._initWithFacebook(a):this._initWithEmailSignup(a)},initializeRemoteControl:function(a,b){"undefined"===typeof b&&null!==typeof a.signupByEmailToken&&
(b=a.signupByEmailToken);var c=this,d=function(){c.SPR.setReferrer(a.creationReferral);c.SPR.addOnClientConnectionFailedListener(c.onClientFailed);c.SPR.addOnClientConnectedListener(function(){c.onClientConnected()});if(typeof a.onSuccess==="function")a.onSuccess()},f={shouldUseWebPlayer:Spotify.RegistrationModule.parameters.useWebPlayer&&Spotify.Webplayer.isCompatible()};this.SPR="undefined"!==typeof b?SpotifyRemote.init(a.token,b,d,f):SpotifyRemote.init(a.token,void 0,d,f)},playUri:function(){var a=
Spotify.RegistrationModule.getContextUri();Spotify.RegistrationModule.useWebPlayer()?Spotify.Webplayer.open({uri:a,checkIsLinkSpotified:!0,source:"music.yahoo.com"===Spotify.RegistrationModule.parameters.creationPoint?"yahoo":"spb"}):"explorer"===Spotify.BrowserDetect.browser.toLowerCase()?window.location=a:Spotify.Util.setLocationWithIframe(a)},onClientConnected:function(){var a=Spotify.RegistrationModule.getContextUri(),b=Spotify.RemoteControlInit;null!==a&&b.SPR.playSpotifyURI(a);window.onbeforeunload=
null;window.setTimeout(function(){window.close();window.onbeforeunload=null},1E4);Spotify.setSpotified(!0);b.trigger("onConnected")},onClientFailed:function(){var a=Spotify.RemoteControlInit;if(!a.lastTimeFailed){var b=Spotify.RegistrationModule.getContextUri();a.SPR.playSpotifyURI(b);a.lastTimeFailed=!0;window.setTimeout(function(){a.playUri()},18E4)}a.trigger("onFailed")}};return d}(Spotify||{});Spotify=function(d){d.PopupInfo={DOWNLOAD:{id:"download",size:[535,375]},SELECT_LOGIN:{id:"select-login",size:[323,394]},SIGNUP_EMAIL:{id:"select-login-email",size:[323]},FACEBOOK_LOGIN:{id:"facebook-login",size:[640,427]},FACEBOOK_GDP:{id:"facebook-gdp",size:[640,427]},OPEN_WEBPLAYER:{id:"open-webplayer",size:[323,334]},COUNTRY:{id:"country",size:[323,394]},ALREADY:{id:"already-have-spotify",size:[323,323]}};d.PopupManager=function(){var a={},b=d.PopupInfo,c=null;this.create=function(c,e){"undefined"===
typeof e&&(e={});"undefined"===typeof e.autoClose&&(e.autoClose=!0);if(!f(c))switch(c){case b.ALREADY.id:a[c]=new d.Popup({template:document.getElementById("already-have-spotify-template"),size:b.ALREADY.size,actions:d.Actions.Already,id:c,popupWindow:!0});break;case b.OPEN_WEBPLAYER.id:a[c]=new d.Popup({template:document.getElementById("open-webplayer-template"),size:b.OPEN_WEBPLAYER.size,actions:d.Actions.WebPlayer,id:c,popupWindow:!0});break;case b.DOWNLOAD.id:a[c]=new d.Popup({template:document.getElementById("download-template"),
size:b.DOWNLOAD.size,actions:d.Actions.Download,id:c,popupWindow:!0,onBeforeShow:function(){Spotify.RegistrationModule.Tutorial.initialize();Spotify.Download.triggerDownload(1500);if(!Spotify.BrowserDetect.browser.toLowerCase()==="explorer"&&!Spotify.RegistrationModule.parameters.overlayMode)Spotify.Util.onUnload(function(){return"Please keep this window open. It will automatically log you into Spotify. Thanks."})}});break;case b.SELECT_LOGIN.id:a[c]=new d.Popup({template:document.getElementById("signup-template"),
size:b.SELECT_LOGIN.size,id:c,actions:d.Actions.Signup,popupWindow:!0,onBeforeShow:function(){window.onbeforeunload=null}});break;case b.SIGNUP_EMAIL.id:a[c]=new d.Popup({template:document.getElementById("signup-email-template"),size:b.SIGNUP_EMAIL.size,id:c,actions:d.Actions.SignupEmail,popupWindow:!0,onBeforeShow:function(){document.querySelector('input[name="username"]').focus()}});break;case b.COUNTRY.id:a[c]=new d.Popup({template:document.getElementById("country-template"),size:b.COUNTRY.size,
id:c,actions:d.Actions.Country,popupWindow:!0,onBeforeShow:function(){document.querySelector('input[name="country-email"]').focus()}})}};var e=!1;this.onResize=function(){!1===e&&(e=!0,window.setTimeout(function(){var b=a[c].size();d.Util.resizeWindow(b);e=!1},100))};this.isVisible=function(b){var c=!1;f(b)&&(c=a[b].isVisible());return c};this.isInitialized=function(a){return f(a)};this.show=function(b){f(b)&&(a[b].show(),c=b,this.onResize(),Spotify.Util.attachEvent("resize",this.onResize))};this.hide=
function(b,c){f(b)&&(a[b].hide(),c&&(a[b].destroyElement(),delete a[b]),Spotify.Util.removeEvent("resize",this.onResize))};var f=function(b){return"undefined"!==typeof a[b]}};return d}(Spotify||{});Spotify||(Spotify={});
Spotify.RegistrationModule=function(d){var a={windows:["1. Save and download Spotify","2. Open SpotifySetup.exe"],mac:["1. Save and download Spotify","2. Run the Spotify installer"],"mac-app":["1. Save and download Spotify","2. Run the Spotify installer"]};d.Tutorial={initialize:function(){var a=this.getClassName(),c=this.getTexts(a);document.querySelector(".spotify-tutorial").className+=" "+a;document.querySelector(".tutorial-text-step-1").style.display="block";document.querySelector(".tutorial-text-step-1").innerHTML=c[0];
document.querySelector(".tutorial-text-step-2").style.display="block";document.querySelector(".tutorial-text-step-2").innerHTML=c[1]},getTexts:function(b){var c=["",""];"undefined"!==typeof a[b]&&2==a[b].length&&(c=a[b]);return c},getClassName:function(){var a="mac",c=Spotify.Config.get("download-links"),d=Spotify.BrowserDetect.OS.toLowerCase();if("undefined"!==typeof c[d])var f=Spotify.Download.getInstallerType(c);"windows"===d?a="windows":"mac"===d&&"app"===f&&(a="mac-app");return a}};return d}(Spotify.RegistrationModule||
{});Spotify.RegistrationModule=function(d){d.LoadingProgress={_getLoaderContainer:function(a){return document.querySelector("#"+a+" .spotify-signup-fb-block")},_getLoader:function(a){var a=this._getLoaderContainer(a),b=document.createElement("div");b.className="spotify-loader";b.style.marginTop=a.offsetHeight/2-16+"px";return b},show:function(a){var b=this._getLoaderContainer(a),c=this._getLoader(a);b.innerHTML="";b.appendChild(c);a=document.querySelector("#"+a+" .already-get-spotify");Spotify.Util.addClass(a,
"loading");a.innerHTML="Opening Spotify..."}};return d}(Spotify.RegistrationModule||{});Spotify||(Spotify={});
Spotify.Actions=function(d,a){d.Signup={"spotify-signup-facebook":function(){a.parameters.overlayMode?(a.Tracking.send(a.Tracking.SIGNUP_FACEBOOK),a.getFBBridge().login(function(){a.popupManager.hide(Spotify.PopupInfo.SELECT_LOGIN.id);a.onFbConnect()},function(){})):a.Tracking.send(a.Tracking.SIGNUP_FACEBOOK,function(){a.redirectToFacebookCheck()})},"spotify-signup-email":function(){a.Tracking.send(a.Tracking.SIGNUP_EMAIL);var b=a.getPopupManager();b.hide(Spotify.PopupInfo.SELECT_LOGIN.id);b.show(Spotify.PopupInfo.SIGNUP_EMAIL.id)},
"spotify-login-already":function(){a.Tracking.send(a.Tracking.ALREADY_HAVE_SPOTIFY);var b=a.getPopupManager();b.hide(Spotify.PopupInfo.SELECT_LOGIN.id);b.show(Spotify.PopupInfo.ALREADY.id)}};return d}(Spotify.Actions||{},Spotify.RegistrationModule);Spotify||(Spotify={});
Spotify.Actions=function(d,a){var b=null,c=null,e=!1,f=function(a){"undefined"===typeof a&&(a=!0);e=a;b.querySelector(".loading-progress").className=a?"loading-progress show":"loading-progress";b.querySelector(".spotify-signup").className=a?"spotify-sprite spotify-button spotify-signup waiting":"spotify-sprite spotify-button spotify-signup";b.querySelector(".spotify-back").className=a?"spotify-sprite spotify-button spotify-back waiting":"spotify-sprite spotify-button spotify-back"},g=function(a,b){if(a.fullValidation||
-1<k.initializedFields.indexOf(a.eventTarget.name))b||(b=a.text),a.eventTarget.className="error",h(b)},h=function(a){c.innerHTML=a;c.style.display="block";b.querySelector("h2").style.display="none";b.querySelector(".spotify-signup-fb-block").style.marginTop="-15px"},l=function(){c.style.display="none";Spotify.RegistrationModule.getPopupManager().onResize();b.querySelector("h2").style.display="block";b.querySelector(".spotify-signup-fb-block").style.marginTop="0"},k={errorFields:[],total:0,onSuccess:null,
initializedFields:[]},m=function(a){var b=a.eventTarget.className;-1<b.indexOf("error")&&(a.eventTarget.className=b.replace("error","ok"))},o=function(a){"undefined"===typeof a&&(a=!0);var c=d.SignupEmail.formFields,e;for(e in c)if(c.hasOwnProperty(e)){var f=b.querySelector(e);a?f.setAttribute("disabled","disabled"):f.removeAttribute("disabled")}},n=function(a,b){var c=k.errorFields.indexOf(a);k.total--;b&&-1===c?k.errorFields.push(a):!b&&-1<c&&k.errorFields.splice(c,1);for(var d=c=0;d<k.initializedFields.length;d++)-1<
k.errorFields.indexOf('input[name="'+k.initializedFields[d]+'"]')&&c++;1<c?h("Please review the invalid fields."):0===c&&l();if(0==k.total&&"function"===typeof k.onSuccess)k.onSuccess(k.errorFields);else 0==k.total?0===k.errorFields.length&&(p(),l()):p()},p=function(){var a=b.querySelector(".spotify-button.spotify-signup");0===k.errorFields.length?a.className=a.className.replace("disabled",""):-1===a.className.indexOf("disabled")&&(a.className+=" disabled")},q={},r={},s={},t={},v=function(a,b,c){var d=
document.querySelector(b),e=d.value,f=!1;a.eventTarget=d;a.fullValidation="undefined"===typeof c?!0:!1;if("function"===typeof a.customCheck&&!a.customCheck(e))return g(a,a.text),n(b,!0),!0;if("undefined"!==typeof a.service){if(e.length<a.length)return g(a,a.text),n(b,!0),!0;c={};c[d.name]=e;(void 0===typeof q[d.name]||e!==q[d.name])&&(void 0===typeof r[d.name]||!r[d.name])?(r[d.name]=!0,q[d.name]=e,Spotify.Util.ajax(a.service,c,function(c){window.setTimeout(function(){r[d.name]=!1},400);if("undefined"!==
typeof c.valid&&c.valid)m(a);else{var e=c.message?c.message:"";t[d.name]=e;g(a,e);f=!0}"undefined"===typeof c.valid&&(q[d.name]="");s[d.name]=f;n(b,f)},1E3,!0)):(n(b,s[d.name]),s[d.name]&&g(a,"undefined"!==typeof t[d.name]?t[d.name]:""))}else"undefined"!==typeof a.regex&&(e.match(a.regex)?m(a):(g(a),f=!0),n(b,f))},u=function(a,b){var c=d.SignupEmail.formFields;k.total=5;k.errorFields=[];k.onSuccess=a;"undefined"!==typeof b&&-1===k.initializedFields.indexOf(b.name)&&k.initializedFields.push(b.name);
for(var e in c)c.hasOwnProperty(e)&&v(c[e],e,b)};d.SignupEmail={formFields:{'input[name="username"]':{service:"/registration/xhr/check-login.php",length:4,text:"Ooops, your username is too short. Please make it longer."},'input[name="password"]':{regex:"[a-zA-Z0-9]{4,}",text:"Your password appears to be wrong. Please try again."},'input[name="email"]':{service:"/registration/xhr/check-login.php",length:4,text:"Please enter a valid email address."},'input[name="email_confirm"]':{regex:"(.+)@(.+){2,}.(.+){2,}",
text:"Your email addresses don\u2019t seem to match.",customCheck:function(a){return a===b.querySelector('input[name="email"]').value}},'input[name="age"]':{regex:"[0-9]{2,}",text:"We're really sorry, but you need to be at least 13 to use Spotify.",customCheck:function(a){return 13<=parseInt(a,10)&&/^\d+$/.test(a)}}},"spotify-back":function(){if(e)return!0;var b=a.getPopupManager();b.hide(Spotify.PopupInfo.SIGNUP_EMAIL.id);b.show(Spotify.PopupInfo.SELECT_LOGIN.id)},"spotify-create-account":function(){if(e)return!0;
u(function(b){if(0===b.length){var c=d.SignupEmail.formFields,b={},e;for(e in c)if(c.hasOwnProperty(e)){var g=document.querySelector(e);b[g.name]=g.value}e=document.querySelectorAll('input[name="gender"]');b.gender=e[0].checked?e[0].value:e[1].value;f();o();b.creation_flow=a.parameters.creationFlow;b.creation_point=a.parameters.creationPoint;b.creation_referral=a.parameters.creationReferral;Spotify.Util.ajax("/registration/xhr/register.php",b,function(b){var c=a.Tracking.DOWNLOAD_SIGNUP_EMAIL;if("undefined"!==
typeof b.status&&1==b.status&&"undefined"!==typeof b.token){var d=b.token;a.setSignupByEmailToken(d);Spotify.Util.isIE8()&&(window.location.hash="emailAuth="+d);d=a.getPopupManager();d.hide(Spotify.PopupInfo.SIGNUP_EMAIL.id);a.useWebPlayer()?(Spotify.Actions.WebPlayer.TokenControl.set(b.token),d.show(Spotify.PopupInfo.OPEN_WEBPLAYER.id)):d.show(Spotify.PopupInfo.DOWNLOAD.id)}else h("Oh, an error has occurred. Please try again later."),c=a.Tracking.SIGNUP_EMAIL_FAILED;f(!1);o(!1);a.Tracking.send(c)},
void 0,!0)}else h("Please review the invalid fields.")})},onRender:function(){b=document.getElementById("signup-email-template");c=b.querySelector(".spotify-negative-feedback");for(var a in this.formFields)this.formFields.hasOwnProperty(a)&&function(){Spotify.Util.attachEvent("blur",function(a){a=Spotify.Util.eventTarget(a);u(null,a)},b.querySelector(a))}(this.formFields[a])}};return d}(Spotify.Actions||{},Spotify.RegistrationModule);Spotify||(Spotify={});Spotify.Actions=function(d){d.Download={"spotify-download-link":function(){window.onbeforeunload=null;Spotify.Download.triggerDownload()}};return d}(Spotify.Actions||{},Spotify.RegistrationModule);Spotify||(Spotify={});
Spotify.Actions=function(d,a){var b=function(){var a=document.querySelector(".what-is-spotify");a.className+=" loading";a.innerHTML="Opening Spotify...";a.href="#";a.onclick=function(){return!1}};d.Country={"country-email-send":function(){var b=document.querySelector('input[name="country-email"]'),d=b.value;""!==d?$.ajax({url:"../l/?t=10&email="+d+"&ref="+encodeURIComponent(a.parameters.creationReferral),success:function(){window.setTimeout(function(){a.parameters.overlayMode?Spotify.Publisher.getInstance().send(Spotify.Message.CONTROL_POPUP,
{popupId:"registration-module",control:"hide"},window.parent):window.close()},300)}}):b.style.border="1px solid #dd231e"},"country-login-already":function(){a.Tracking.send(a.Tracking.ALREADY_HAVE_SPOTIFY);a.playContext(!0);b();document.querySelector("#country-template .spotify-signup-fb-block").innerHTML='<div class="spotify-loader"></div>';document.getElementById("spotify-login-already").style.display="none"}};return d}(Spotify.Actions||{},Spotify.RegistrationModule);Spotify||(Spotify={});
Spotify.Actions=function(d,a){var b=null,c=function(a,c){var d=a.getPopupManager();b=window.setTimeout(function(){!0===confirm("We couldn't open Spotify for you. Would you like to download Spotify?")&&(d.hide(Spotify.PopupInfo.ALREADY.id),d.show(Spotify.PopupInfo.DOWNLOAD.id))},c);Spotify.RemoteControlInit.attach("onConnected",function(){window.clearInterval(b)})};d.Already={"spotify-already-start":function(){a.playContext(!0);a.useWebPlayer()?a.close():(a.LoadingProgress.show("already-have-spotify-template"),c(a,
3E4))},"already-get-spotify":function(){if(a.useWebPlayer())a.playContext(!0),a.close();else{var b=a.getPopupManager();b.hide(Spotify.PopupInfo.ALREADY.id);b.show(Spotify.PopupInfo.DOWNLOAD.id)}}};return d}(Spotify.Actions||{},Spotify.RegistrationModule);Spotify||(Spotify={});Spotify.Actions=function(d,a){var b=null;d.WebPlayer={"spotify-open-webplayer":function(){var c="music.yahoo.com"===a.parameters.creationPoint;Spotify.Webplayer.open({uri:a.parameters.uri,fbBridge:a.getFBBridge(),token:b,source:c?"yahoo":"spb",checkIsLinkSpotified:!0});Spotify.Publisher.getInstance().send(Spotify.Message.CHECK_CLIENT,{},window.parent);a.close()},TokenControl:{set:function(a){b=a}}};return d}(Spotify.Actions||{},Spotify.RegistrationModule);Spotify=function(d){var a={INSTALLER_APP:"app",INSTALLER_DEFAULT:"default",windows:function(){return this.INSTALLER_DEFAULT},mac:function(){var a=this.INSTALLER_DEFAULT;null===Spotify.BrowserDetect.getUserAgent().match(/OS X 10.4/)&&(a=this.INSTALLER_APP);return a}};d.Download=new function(){var b=function(a,b){var c="",d=Spotify.BrowserDetect.OS.toLowerCase();"undefined"!==typeof a[d]&&(a=a[d],c="undefined"!==typeof a[b]?a[b]:a[this.INSTALLER_DEFAULT]);return c},c=Spotify.RegistrationModule;this.triggerDownload=
function(a){var b=this;window.setTimeout(function(){var a=b.getInstallerLink();""!==a&&(Spotify.Util.setLocationWithIframe(a),c.playContext())},"undefined"===typeof a?100:1500)};this.getInstallerType=function(b){var c=this.INSTALLER_DEFAULT,d=Spotify.BrowserDetect.OS.toLowerCase();"undefined"!==typeof b[d]&&"function"===typeof a[d]&&(c=a[d](b[d]));return c};this.getInstallerLink=function(){var a=Spotify.Config.get("download-links"),c=this.getInstallerType(a);return b(a,c)}};return d}(Spotify||{});
